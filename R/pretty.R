# Function to produce very basic table, no lines or headings
baretable <- function(
  tbl,
  digits = 0,
  include.colnames = FALSE,
  include.rownames = FALSE,
  hline.after = NULL,
  size = getOption("xtable.size", NULL),
  add.to.row = getOption("xtable.add.to.row", NULL),
  longtable = FALSE,
  ...
) {
  xtable::xtable(tbl, digits = digits, ...) |>
    print(
      include.colnames = include.colnames,
      include.rownames = include.rownames,
      hline.after = hline.after,
      comment = FALSE,
      tabular.environment = if_else(longtable, "longtable", "tabular"),
      floating = FALSE,
      size = size,
      add.to.row = add.to.row,
      sanitize.text.function = function(x) {
        x
      }
    )
}

# Return dollars in pretty manner.
# Similar to prettyNum but with $ sign and working for numbers greater than 1e7
dollars <- function(x) {
  out <- paste0("\\$", sprintf("%.0f", x))
  paste0(gsub(
    "^0+\\.",
    ".",
    unname(prettyNum(out, ",", preserve.width = "none", scientific = FALSE))
  ))
}
